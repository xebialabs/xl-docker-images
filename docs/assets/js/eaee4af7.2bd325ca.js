"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[479],{3905:function(e,t,o){o.d(t,{Zo:function(){return u},kt:function(){return m}});var r=o(7294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function l(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var i=r.createContext({}),p=function(e){var t=r.useContext(i),o=t;return e&&(o="function"==typeof e?e(t):l(l({},t),e)),o},u=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var o=e.components,n=e.mdxType,a=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=p(o),m=n,h=d["".concat(i,".").concat(m)]||d[m]||c[m]||a;return o?r.createElement(h,l(l({ref:t},u),{},{components:o})):r.createElement(h,l({ref:t},u))}));function m(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=o.length,l=new Array(a);l[0]=d;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s.mdxType="string"==typeof e?e:n,l[1]=s;for(var p=2;p<a;p++)l[p]=o[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,o)}d.displayName="MDXCreateElement"},5922:function(e,t,o){o.r(t),o.d(t,{frontMatter:function(){return s},contentTitle:function(){return i},metadata:function(){return p},toc:function(){return u},default:function(){return d}});var r=o(7462),n=o(3366),a=(o(7294),o(3905)),l=["components"],s={sidebar_position:1},i="XL Release active-active cluster setup with docker compose",p={unversionedId:"manual/xl-release-ha/README",id:"manual/xl-release-ha/README",isDocsHomePage:!1,title:"XL Release active-active cluster setup with docker compose",description:"The production setup for XL Release as mentioned here can be done using Docker compose as below.",source:"@site/docs/manual/xl-release-ha/README.md",sourceDirName:"manual/xl-release-ha",slug:"/manual/xl-release-ha/README",permalink:"/xl-docker-images/docs/manual/xl-release-ha/README",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Upgrade XL Deploy active-active cluster setup with docker compose",permalink:"/xl-docker-images/docs/manual/xl-deploy-ha/upgrade-multi-node-deployment"},next:{title:"Upgrade XL Release active-active cluster setup with docker compose",permalink:"/xl-docker-images/docs/manual/xl-release-ha/upgrade-multi-node-deployment"}},u=[{value:"setup",id:"setup",children:[],level:3},{value:"Limitations:",id:"limitations",children:[],level:3},{value:"Steps",id:"steps",children:[{value:"For Upgrade procedures please check this upgrade multi node deployment",id:"for-upgrade-procedures-please-check-this-upgrade-multi-node-deployment",children:[],level:4}],level:3}],c={toc:u};function d(e){var t=e.components,o=(0,n.Z)(e,l);return(0,a.kt)("wrapper",(0,r.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"xl-release-active-active-cluster-setup-with-docker-compose"},"XL Release active-active cluster setup with docker compose"),(0,a.kt)("p",null,"The production setup for XL Release as mentioned ",(0,a.kt)("a",{parentName:"p",href:"https://docs.xebialabs.com/v.9.0/xl-release/how-to/set-up-xl-release-production/#production-environment-setup"},"here")," can be done using Docker compose as below."),(0,a.kt)("p",null,"This is a sample, you can follow this approach to setup the database and other infrastructure of your choice."),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Note 1"),": For production deployments it is advised that you use Kubernetes to orchestrate the deployment of the applications. Docker compose is not ideal for production setup. Proceed at your own risk. Use the ",(0,a.kt)("inlineCode",{parentName:"p"},"xl up")," command from the official XebiaLabs CLI to install XebiaLabs products using Kubernetes, for more details see ",(0,a.kt)("a",{parentName:"p",href:"https://docs.xebialabs.com/v.9.5/xl-deploy/concept/xl-up-manage-deployments"},"Manage Deployments with XL Up")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Note 2"),": For HA setup to work, you need to mount a licence file or provide an environment variable ",(0,a.kt)("inlineCode",{parentName:"p"},"XL_LICENSE")," with a licence text converted to base64 for the XL Release instances"),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"Note 3"),": The folders you mount needs to be owned by user 10001, for example, you can run ",(0,a.kt)("inlineCode",{parentName:"p"},"sudo chown -R 10001 xl-release")," if you are going to mount directories under ",(0,a.kt)("inlineCode",{parentName:"p"},"$PWD/xl-release")," folder."),(0,a.kt)("h3",{id:"setup"},"setup"),(0,a.kt)("p",null,"The setup includes"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"A load balancer with HaProxy"),(0,a.kt)("li",{parentName:"ul"},"PostgreSQL database single node setup"),(0,a.kt)("li",{parentName:"ul"},"XL Release master nodes")),(0,a.kt)("h3",{id:"limitations"},"Limitations:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The database setup is for demo purposes, use your own setup or use external database"),(0,a.kt)("li",{parentName:"ul"},"The HAproxy setup is for demo purposes, use your own setup")),(0,a.kt)("h3",{id:"steps"},"Steps"),(0,a.kt)("p",null,"Follow the below steps to deploy the sample"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Download the ",(0,a.kt)("inlineCode",{parentName:"li"},"docker-compose-xlr-ha.yaml")," file here"),(0,a.kt)("li",{parentName:"ol"},"You can use the provided ",(0,a.kt)("inlineCode",{parentName:"li"},"run.sh")," to bring up the setup or do it manually with below steps, change the passwords as required in either case.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# Set passwords\nexport XLR_ADMIN_PASS=admin\nexport POSTGRES_PASS=admin\n\n# deploy master nodes, load balancer, mq and database.\ndocker-compose -f docker-compose-xlr-ha.yaml up --scale xl-release-master=2 -d\n\n# Print out the status\ndocker-compose -f docker-compose-xlr-ha.yaml ps\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"You can view the logs of individual containers using the ",(0,a.kt)("inlineCode",{parentName:"li"},"docker logs <container_name> -f")," command."),(0,a.kt)("li",{parentName:"ol"},"You can access XL Release UI at http://localhost:8081"),(0,a.kt)("li",{parentName:"ol"},"To shutdown the setup you can run below")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"# Shutdown deployments\ndocker-compose -f docker-compose-xlr-ha.yaml down\n")),(0,a.kt)("h4",{id:"for-upgrade-procedures-please-check-this-upgrade-multi-node-deployment"},"For Upgrade procedures please check this ",(0,a.kt)("a",{parentName:"h4",href:"./upgrade-multi-node-deployment"},"upgrade multi node deployment")))}d.isMDXComponent=!0}}]);